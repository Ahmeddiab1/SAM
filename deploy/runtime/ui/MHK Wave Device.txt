MHK Wave Device
1608
761
12
GroupBox

1
7
Name
5
9
GroupBox1
X
3
3
Y
3
6
Width
3
950
Height
3
725
Caption
5
10
MHK Device
Bold
2
1
Button

1
7
Name
5
7
btnPlot
X
3
987
Y
3
174
Width
3
90
Height
3
24
Caption
5
4
Plot
TabOrder
3
4294967295
Numeric

1
16
Name
5
14
number_devices
X
3
1092
Y
3
114
Width
3
90
Height
3
24
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
GroupBox

1
7
Name
5
8
object 4
X
3
30
Y
3
375
Width
3
844
Height
3
340
Caption
5
11
Probability
Bold
2
1
GroupBox

1
7
Name
5
9
object 41
X
3
30
Y
3
27
Width
3
844
Height
3
340
Caption
5
11
Power Curve
Bold
2
1
DataMatrix

1
22
Name
5
16
wave_power_curve
X
3
48
Y
3
57
Width
3
800
Height
3
300
PasteAppendRows
2
0
PasteAppendCols
2
0
ShowRows
2
1
ShowRowLabels
2
0
RowLabels
5
0
ShadeR0C0
2
0
ShadeC0
2
0
ShowCols
2
1
ShowColLabels
2
1
ColLabels
5
0
NumRowsLabel
5
5
Rows:
NumColsLabel
5
5
Cols:
Layout
3
0
ChoiceColumn
3
4294967295
Choices
5
15
Choice1,Choice2
HideColumn
3
4294967295
ShowColumn
3
4294967295
DataMatrix

1
22
Name
5
24
wave_resource_definition
X
3
51
Y
3
402
Width
3
800
Height
3
300
PasteAppendRows
2
0
PasteAppendCols
2
0
ShowRows
2
1
ShowRowLabels
2
0
RowLabels
5
0
ShadeR0C0
2
0
ShadeC0
2
0
ShowCols
2
1
ShowColLabels
2
1
ColLabels
5
0
NumRowsLabel
5
5
Rows:
NumColsLabel
5
5
Cols:
Layout
3
0
ChoiceColumn
3
4294967295
Choices
5
15
Choice1,Choice2
HideColumn
3
4294967295
ShowColumn
3
4294967295
Numeric

1
16
Name
5
19
wind_resource_shear
X
3
1092
Y
3
81
Width
3
100
Height
3
21
Value
1
0.14
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
16
Name
5
19
wind_turbine_hub_ht
X
3
1092
Y
3
57
Width
3
100
Height
3
21
Value
1
80
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
16
Name
5
22
wind_turbine_kw_rating
X
3
1092
Y
3
9
Width
3
100
Height
3
21
Value
1
1500
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
3
 kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
Plot

1
5
Name
5
29
wind_turbine_power_curve_plot
X
3
960
Y
3
237
Width
3
573
Height
3
414
Numeric

1
16
Name
5
27
wind_turbine_rotor_diameter
X
3
1092
Y
3
33
Width
3
100
Height
3
21
Value
1
75
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14

7
number_devices
3
1
 
 
 
0
0
1
0
Numeric
wave_power_curve
3
3
 
 
 
0
0
1
0
DataMatrix
wave_resource_definition
3
3
 
 
 
0
0
1
3
1
1
0
DataMatrix
wind_resource_shear
3
1
 
 
 
0
0
1
0
Numeric
wind_turbine_hub_ht
3
1
 
 
 
0
0
1
0
Numeric
wind_turbine_kw_rating
3
1
 
 
 
0
0
1
0
Numeric
wind_turbine_rotor_diameter
3
1
 
 
 
0
0
1
0
Numeric

0
1051
function plot_turbine_curve()
{
	setplot('wind_turbine_power_curve_plot');
	clearplot('wind_turbine_power_curve_plot');
	plotopt( {'title'='Energy Production','backcolor'=[0,255,0]}  );

	
	z_min = 9e99;
	z_max = -9e99;
	pc_all = ${wave_power_curve};
	pd_all = ${wave_resource_definition};
	// initially assume same size
	x = alloc(#pc_all - 1, #pc_all[0] - 1);
	y = alloc(#pc_all - 1, #pc_all[0] - 1);
	z = alloc(#pc_all - 1, #pc_all[0] - 1);
	for (r=1;r<#z;r++)
	{
		for (c=1;c<#z[0];c++)
		{
			y[r-1][c-1] = pc_all[r][0];
			x[r-1][c-1] = pd_all[0][c];
			z[r-1][c-1] = pc_all[r][c] * pd_all[r][c]*8760/100;
			if (z[r-1][c-1] < z_min) z_min = z[r-1][c-1];
			if (z[r-1][c-1] > z_max) z_max = z[r-1][c-1];
		}
	}
	
	contour( x, y, z, {'filled'=true, 'levels'=15, min=z_min, max=z_max});	
	
	// show any error messages
	set_error_msg();
}

function set_error_msg()
{	
	// Start with a fresh error message
	errmsg = '';

}


on_change{'btnPlot'}=define()
{
	plot_turbine_curve();
};

on_load{'MHK Wave Device'}=define()
{
	plot_turbine_curve();
};

